From 1c7da1cf916ab953f84beb7515576ceba129f99c Mon Sep 17 00:00:00 2001
From: Emilio Pozuelo Monfort <pochu27@gmail.com>
Date: Wed, 27 Mar 2013 16:16:08 +0100
Subject: [PATCH 3/3] cursor: set error if we don't have the necessary X
 support

Otherwise we crash in impl_activate()

https://bugzilla.gnome.org/show_bug.cgi?id=696707
---
 plugins/cursor/gsd-cursor-manager.c |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/plugins/cursor/gsd-cursor-manager.c b/plugins/cursor/gsd-cursor-manager.c
index ddc6dc6..3e9727d 100644
--- a/plugins/cursor/gsd-cursor-manager.c
+++ b/plugins/cursor/gsd-cursor-manager.c
@@ -294,12 +294,16 @@ gsd_cursor_manager_start (GsdCursorManager  *manager,
         gnome_settings_profile_start (NULL);
 
         if (supports_cursor_xfixes () == FALSE) {
-                g_debug ("XFixes cursor extension not available, will not hide the cursor");
+                g_set_error (error, GSD_CURSOR_MANAGER_ERROR,
+                             GSD_CURSOR_MANAGER_ERROR_FAILED,
+                             "XFixes cursor extension not available");
                 return FALSE;
         }
 
         if (supports_xinput_devices () == FALSE) {
-                g_debug ("XInput support not available, will not hide the cursor");
+                g_set_error (error, GSD_CURSOR_MANAGER_ERROR,
+                             GSD_CURSOR_MANAGER_ERROR_FAILED,
+                             "XInput support not available");
                 return FALSE;
         }
 
-- 
1.7.10.4

